<%= turbo_frame_tag @promotion, dom_id(promotion_action) do %>
  <div class="promotion_action promotion-block">
    <h6 class='promotion-title'> <%= promotion_action.model_name.human %></h6>

    <% if can?(:destroy, promotion_action) %>
      <%= link_to_with_icon 'trash', '', solidus_friendly_promotions.admin_promotion_promotion_action_path(@promotion, promotion_action), method: :delete, class: 'delete' %>
    <% end %>


    <%= render "solidus_friendly_promotions/admin/promotion_actions/calculator_select",
      path: solidus_friendly_promotions.edit_admin_promotion_promotion_action_path(@promotion, promotion_action),
      promotion_action: promotion_action %>

    <%=
      form_with(
      model: promotion_action,
      scope: :promotion_action,
      url: solidus_friendly_promotions.admin_promotion_promotion_action_path(@promotion, promotion_action),
      data: { turbo: false }
    ) do |form| %>
      <%= render 'solidus_friendly_promotions/admin/promotion_actions/form', form: form %>
      <div class="row">
        <div class="col-12">
          <%= button_tag "Update", class: "btn btn-secondary float-right" %>
        </div>
      </div>
    <% end %>

    <fieldset>
      <legend align="center"><%= t("action_rules", scope: :solidus_friendly_promotions) %></legend>

      <%= render partial: 'solidus_friendly_promotions/admin/promotion_rules/promotion_rule', collection: promotion_action.relevant_rules, locals: { promotion_action: promotion_action } %>

      <%= turbo_frame_tag @promotion, "new_promotion_action_rule" do %>
        <%= link_to t(:add_rule, scope: :solidus_friendly_promotions), solidus_friendly_promotions.new_admin_promotion_promotion_rule_path(@promotion, promotion_action_id: promotion_action), class: 'btn btn-secondary' %>
      <% end %>
    </fieldset>
  </div>
<% end %>
